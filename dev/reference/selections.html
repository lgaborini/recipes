<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Methods for Select Variables in Step Functions — selections • recipes</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href="../tidymodels.css" rel="stylesheet">




<meta property="og:title" content="Methods for Select Variables in Step Functions — selections" />
<meta property="og:description" content="When selecting variables or model terms in step
functions, dplyr-like tools are used. The selector functions
can choose variables based on their name, current role, data
type, or any combination of these. The selectors are passed as
any other argument to the step. If the variables are explicitly
stated in the step function, this might be similar to:

  recipe( ~ ., data = USArrests) %&amp;gt;%
    step_pca(Murder, Assault, UrbanPop, Rape, num = 3)

The first four arguments indicate which variables should be
used in the PCA while the last argument is a specific argument
to step_pca().
Note that:

The selector arguments should not contain functions
beyond those supported (see below).
These arguments are not evaluated until the prep
function for the step is executed.
The dplyr-like syntax allows for negative signs to
exclude variables (e.g. -Murder) and the set of selectors will
processed in order.
A leading exclusion in these arguments (e.g. -Murder)
has the effect of adding all variables to the list except the
excluded variable(s).


Also, select helpers from the tidyselect package can also be used:
tidyselect::starts_with(), tidyselect::ends_with(),
tidyselect::contains(), tidyselect::matches(),
tidyselect::num_range(), tidyselect::everything(), and
tidyselect::one_of().
For example:

  recipe(Species ~ ., data = iris) %&amp;gt;%
    step_center(starts_with(&quot;Sepal&quot;), -contains(&quot;Width&quot;))

would only select Sepal.Length
Inline functions that specify computations, such as
log(x), should not be used in selectors and will produce an
error. A list of allowed selector functions is below.
Columns of the design matrix that may not exist when the step
is coded can also be selected. For example, when using
step_pca, the number of columns created by feature extraction
may not be known when subsequent steps are defined. In this
case, using matches(&quot;^PC&quot;) will select all of the columns
whose names start with &quot;PC&quot; once those columns are created.
There are sets of functions that can be used to select
variables based on their role or type: has_role() and
has_type(). For convenience, there are also functions that are
more specific: all_numeric(), all_nominal(),
all_predictors(), and all_outcomes(). These can be used in
conjunction with the previous functions described for selecting
variables using their names:

  data(biomass)
  recipe(HHV ~ ., data = biomass) %&amp;gt;%
    step_center(all_numeric(), -all_outcomes())

This results in all the numeric predictors: carbon, hydrogen,
oxygen, nitrogen, and sulfur.
If a role for a variable has not been defined, it will never be
selected using role-specific selectors.
Selectors can be used in step_interact() in similar ways but
must be embedded in a model formula (as opposed to a sequence
of selectors). For example, the interaction specification
could be ~ starts_with(&quot;Species&quot;):Sepal.Width. This can be
useful if Species was converted to dummy variables
previously using step_dummy().
The complete list of allowable functions in steps:

By name: tidyselect::starts_with(),
tidyselect::ends_with(), tidyselect::contains(),
tidyselect::matches(), tidyselect::num_range(), and
tidyselect::everything()
By role: has_role(),
all_predictors(), and all_outcomes()
By type: has_type(), all_numeric(),
and all_nominal()

" />
<meta property="og:image" content="https://recipes.tidymodels.org/logo.png" />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">recipes</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://tidymodels.org">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.12.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/Simple_Example.html">Simple Example</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Selecting_Variables.html">Selecting Variables</a>
    </li>
    <li>
      <a href="../articles/Custom_Steps.html">Custom Steps</a>
    </li>
    <li>
      <a href="../articles/Ordering.html">The Order of Steps</a>
    </li>
    <li>
      <a href="../articles/Dummies.html">Dummy Variables and Interactions</a>
    </li>
    <li>
      <a href="../articles/Roles.html">Column Roles</a>
    </li>
    <li>
      <a href="../articles/Skipping.html">On Skipping Steps</a>
    </li>
    <li>
      <a href="../articles/articles/Subsampling.html">Subsampling for Class Imbalances</a>
    </li>
    <li>
      <a href="../articles/articles/Multivariate_PLS.html">Multivariate Analysis using Partial Least Squares</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidymodels/recipes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Methods for Select Variables in Step Functions</h1>
    <small class="dont-index">Source: <a href='https://github.com/tidymodels/recipes/blob/master/R/selections.R'><code>R/selections.R</code></a></small>
    <div class="hidden name"><code>selections.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When selecting variables or model terms in <code>step</code>
functions, <code>dplyr</code>-like tools are used. The <em>selector</em> functions
can choose variables based on their name, current role, data
type, or any combination of these. The selectors are passed as
any other argument to the step. If the variables are explicitly
stated in the step function, this might be similar to:</p>
<pre>
  <span class='fu'><a href='recipe.html'>recipe</a></span>( ~ <span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>USArrests</span>) <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='step_pca.html'>step_pca</a></span>(<span class='no'>Murder</span>, <span class='no'>Assault</span>, <span class='no'>UrbanPop</span>, <span class='no'>Rape</span>, <span class='kw'>num</span> <span class='kw'>=</span> <span class='fl'>3</span>)</pre>

<p>The first four arguments indicate which variables should be
used in the PCA while the last argument is a specific argument
to <code><a href='step_pca.html'>step_pca()</a></code>.</p>
<p>Note that:</p>
<ol>
<li><p>The selector arguments should not contain functions
beyond those supported (see below).</p></li>
<li><p>These arguments are not evaluated until the <code>prep</code>
function for the step is executed.</p></li>
<li><p>The <code>dplyr</code>-like syntax allows for negative signs to
exclude variables (e.g. <code>-Murder</code>) and the set of selectors will
processed in order.</p></li>
<li><p>A leading exclusion in these arguments (e.g. <code>-Murder</code>)
has the effect of adding all variables to the list except the
excluded variable(s).</p></li>
</ol>

<p>Also, select helpers from the <code>tidyselect</code> package can also be used:
<code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::starts_with()</a></code>, <code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::ends_with()</a></code>,
<code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::contains()</a></code>, <code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::matches()</a></code>,
<code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::num_range()</a></code>, <code><a href='https://tidyselect.r-lib.org/reference/everything.html'>tidyselect::everything()</a></code>, and
<code><a href='https://tidyselect.r-lib.org/reference/one_of.html'>tidyselect::one_of()</a></code>.
For example:</p>
<pre>
  <span class='fu'><a href='recipe.html'>recipe</a></span>(<span class='no'>Species</span> ~ <span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>iris</span>) <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='step_center.html'>step_center</a></span>(<span class='fu'>starts_with</span>(<span class='st'>"Sepal"</span>), -<span class='fu'>contains</span>(<span class='st'>"Width"</span>))</pre>

<p>would only select <code>Sepal.Length</code></p>
<p><strong>Inline</strong> functions that specify computations, such as
<code><a href='https://rdrr.io/r/base/Log.html'>log(x)</a></code>, should not be used in selectors and will produce an
error. A list of allowed selector functions is below.</p>
<p>Columns of the design matrix that may not exist when the step
is coded can also be selected. For example, when using
<code>step_pca</code>, the number of columns created by feature extraction
may not be known when subsequent steps are defined. In this
case, using <code>matches("^PC")</code> will select all of the columns
whose names start with "PC" <em>once those columns are created</em>.</p>
<p>There are sets of functions that can be used to select
variables based on their role or type: <code><a href='has_role.html'>has_role()</a></code> and
<code><a href='has_role.html'>has_type()</a></code>. For convenience, there are also functions that are
more specific: <code><a href='has_role.html'>all_numeric()</a></code>, <code><a href='has_role.html'>all_nominal()</a></code>,
<code><a href='has_role.html'>all_predictors()</a></code>, and <code><a href='has_role.html'>all_outcomes()</a></code>. These can be used in
conjunction with the previous functions described for selecting
variables using their names:</p>
<pre>
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>biomass</span>)
  <span class='fu'><a href='recipe.html'>recipe</a></span>(<span class='no'>HHV</span> ~ <span class='no'>.</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>biomass</span>) <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='step_center.html'>step_center</a></span>(<span class='fu'><a href='has_role.html'>all_numeric</a></span>(), -<span class='fu'><a href='has_role.html'>all_outcomes</a></span>())</pre>

<p>This results in all the numeric predictors: carbon, hydrogen,
oxygen, nitrogen, and sulfur.</p>
<p>If a role for a variable has not been defined, it will never be
selected using role-specific selectors.</p>
<p>Selectors can be used in <code><a href='step_interact.html'>step_interact()</a></code> in similar ways but
must be embedded in a model formula (as opposed to a sequence
of selectors). For example, the interaction specification
could be <code>~ starts_with("Species"):Sepal.Width</code>. This can be
useful if <code>Species</code> was converted to dummy variables
previously using <code><a href='step_dummy.html'>step_dummy()</a></code>.</p>
<p>The complete list of allowable functions in steps:</p>
<ul>
<li><p><strong>By name</strong>: <code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::starts_with()</a></code>,
<code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::ends_with()</a></code>, <code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::contains()</a></code>,
<code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::matches()</a></code>, <code><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>tidyselect::num_range()</a></code>, and
<code><a href='https://tidyselect.r-lib.org/reference/everything.html'>tidyselect::everything()</a></code></p></li>
<li><p><strong>By role</strong>: <code><a href='has_role.html'>has_role()</a></code>,
<code><a href='has_role.html'>all_predictors()</a></code>, and <code><a href='has_role.html'>all_outcomes()</a></code></p></li>
<li><p><strong>By type</strong>: <code><a href='has_role.html'>has_type()</a></code>, <code><a href='has_role.html'>all_numeric()</a></code>,
and <code><a href='has_role.html'>all_nominal()</a></code></p></li>
</ul>

    </div>




  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="tidyverse">
  <p>recipes is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn, <a href='http://hadley.nz'>Hadley Wickham</a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


